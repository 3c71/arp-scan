$Id$

Code tidy up: reduce the number of global variables.

Additional ARP fingerprinting options, e.g. arpsha != srcaddr.

Some OSes, e.g. OpenBSD and NetBSD, don't run man pages through tbl.
There is disagreement about what the first line in the manpage should be.
Solaris 9 says in man(1):
'\" X
Linux sarge says in groff_man(7):
.\" word
In all cases, the letters in word are "e" for eqn, "r" for refer, "t" for tbl.

Why does darwin 7.9 not have prototypes for pcap_datalink_val_to_name(),
pcap_datalink_val_to_description() and pcap_setnonblock() even though the
pcap library contains these functions?  arp-scan compiles with warnings, but
runs OK.

Add support for win32 link-layer send and receive.

Add support for Token Ring.

Support the libpcap sending function pcap_sendpacket() or pcap_inject() when
they are supported by the pcap library.  These two functions are essentially
the same, but pcap_sendpacket() came from WinPcap whereas pcap_inject() came
from OpenBSD.  Need to find portable functions to get interface IP address
and MAC address.  pcap_lookupnet() gets the network address and mask, but not
the IP address.

Use pcap_get_selectable_fd() to get the file descriptor for select().  This
function is not supported on windows.

Investigate response packets >60 bytes long, e.g:
1. Windows 2003 Server:
Example #1 (Server 4)
10:27:40.710842 00:11:43:0f:f2:dd > 00:c0:9f:09:b8:db, ethertype ARP (0x0806), length 106: arp reply server4.nta-monitor.ad.nta-monitor.com is-at 00:11:43:0f:f2:dd
Example #2 (Server 4)
09:53:57.393806 arp reply 192.168.124.204 is-at 00:11:43:0f:f2:dd
        0x0000:  00c0 9f09 b8db 0011 430f f2dd 0806 0001  ........C.......
        0x0010:  0800 0604 0002 0011 430f f2dd c0a8 7ccc  ........C.....|.
        0x0020:  00c0 9f09 b8db c0a8 7c01 0000 0000 0000  ........|.......
        0x0030:  0000 0000 0000 0000 0000 0000 0000 0000  ................
        0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................
        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................
Example #3 (Server 6)
10:12:07.507050 arp reply 192.168.124.207 is-at 00:12:3f:ec:cf:a0
        0x0000:  00c0 9f09 b8db 0012 3fec cfa0 0806 0001  ........?.......
        0x0010:  0800 0604 0002 0012 3fec cfa0 c0a8 7ccf  ........?.....|.
        0x0020:  00c0 9f09 b8db c0a8 7c01 0000 0000 0000  ........|.......
        0x0030:  0000 0000 0000 0000 0000 0000 0000 0000  ................
        0x0040:  0000 0000 0000 0000 0000 0000 0000 0000  ................
        0x0050:  0000 0000 0000 0000 0000 0000 0000 0000  ................
2. Cisco
Example #1
10:27:40.802358 00:06:d7:55:0f:40 > 00:c0:9f:09:b8:db, ethertype ARP (0x0806), length 64: arp reply maple.nta-monitor.com is-at 00:06:d7:55:0f:40

Investigate ARP trailer negotiation, as defined in RFC1122 section 2.3.1,
Trailer Protocol Negotiation: 'the ARP exchange is completed in the usual
manner using the normal IP protocol type, but a host that wants to speak
trailers will send an additional "trailer ARP reply" packet'.  Trailer
encapsulation itself is detailed in RFC 893.

Replace MT19937 PRNG with SFMT19937.

Support LLC/SNAP encapsulation with 802.1Q VLAN tagging (--llc --vlan=n) and
generate the correct packet format.  Currently the VLAN tag is added first,
which is incorrect.
